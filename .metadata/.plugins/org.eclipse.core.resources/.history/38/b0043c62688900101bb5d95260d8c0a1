package web;

import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.select.Elements;

public class Webscrapper2 {
    
    public static void main(String[] args) {
String apiUrl = "https://digital.dmart.in/api/profile/getdetailstoredid-10151";
        
        try {
            HttpClient client = HttpClient.newHttpClient();
            
            HttpRequest request = HttpRequest.newBuilder()
                    .uri(URI.create(apiUrl))
                    .header("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0")
                    .header("Referer", "https://www.dmart.in/category/biscuits---cookies-aesc-biscuitsandcookies")
                    .GET()
                    .build();
            
            HttpResponse<String> response = client.send(request, 
                HttpResponse.BodyHandlers.ofString());
            
            System.out.println("Status: " + response.statusCode());
            
            if (response.statusCode() == 200) {
                String data = response.body();
                System.out.println("Data received: " + data.length() + " characters");
                
                // सिर्फ products extract करें
                extractSimpleProducts(data);
            }
            
        } catch (Exception e) {
            System.out.println("Error: " + e.getMessage());
        }
    }
    
    private static void extractSimpleProducts(String data) {
        System.out.println("\n=== PRODUCTS FOUND ===");
        
        // सिर्फ बिस्कुट/कुकीज़ के नाम ढूंढें
        String[] words = data.split("[\",\\s]+");
        
        for (String word : words) {
            if (word.toLowerCase().contains("biscuit") || 
                word.toLowerCase().contains("cookie") ||
                word.toLowerCase().contains("britannia") ||
                word.toLowerCase().contains("parle")) {
                
                System.out.println("Product: " + word);
            }
        }
        
        // Price patterns ढूंढें
        System.out.println("\n=== PRICES FOUND ===");
        for (String word : words) {
            if (word.contains("₹") || (word.matches("\\d+") && word.length() >= 2)) {
                System.out.println("Price: " + word);
            }
        }
    }
}
