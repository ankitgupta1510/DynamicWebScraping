package flow;

import org.jsoup.Jsoup;
import org.jsoup.Connection.Method;
import org.jsoup.Connection.Response;

import java.io.IOException;

import org.jsoup.Connection;

public class AppRun {
	private static final String url = "https://www.coursera.org/graphql-gateway?opname=Search";
	
	public static void main(String [] args) throws IOException {
		
//		String payloadTemplate = "[{"operationName":"Search","variables":{"requests":[{"entityType":"PRODUCTS","limit":12,"facets":["cost","topic","skills","productDifficultyLevel","productDuration","productTypeDescription","partners","language","subtitleLanguage","isPartOfCourseraPlus"],"sortBy":"BEST_MATCH","maxValuesPerFacet":1000,"facetFilters":[],"cursor":"2","query":""},{"entityType":"SUGGESTIONS","limit":10,"maxValuesPerFacet":1000,"facetFilters":[],"cursor":"0","query":""}]},"query":"query Search($requests: [Search_Request!]!) {\n  SearchResult {\n    search(requests: $requests) {\n      ...SearchResult\n      __typename\n    }\n    __typename\n  }\n}\n\nfragment SearchResult on Search_Result {\n  elements {\n    ...SearchHit\n    __typename\n  }\n  facets {\n    ...SearchFacets\n    __typename\n  }\n  pagination {\n    cursor\n    totalElements\n    __typename\n  }\n  totalPages\n  source {\n    indexName\n    recommender {\n      context\n      hash\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchHit on Search_Hit {\n  ...SearchArticleHit\n  ...SearchProductHit\n  ...SearchSuggestionHit\n  __typename\n}\n\nfragment SearchArticleHit on Search_ArticleHit {\n  aeName\n  careerField\n  category\n  createdByName\n  firstPublishedAt\n  id\n  internalContentEpic\n  internalProductLine\n  internalTargetKw\n  introduction\n  islocalized\n  lastPublishedAt\n  localizedCountryCd\n  localizedLanguageCd\n  name\n  subcategory\n  topics\n  url\n  skill: skills\n  __typename\n}\n\nfragment SearchProductHit on Search_ProductHit {\n  avgProductRating\n  cobrandingEnabled\n  completions\n  duration\n  id\n  imageUrl\n  isCourseFree\n  isCreditEligible\n  isNewContent\n  isPartOfCourseraPlus\n  name\n  numProductRatings\n  parentCourseName\n  parentLessonName\n  partnerLogos\n  partners\n  productCard {\n    ...SearchProductCard\n    __typename\n  }\n  productDifficultyLevel\n  productDuration\n  productType\n  skills\n  url\n  videosInLesson\n  translatedName\n  translatedSkills\n  translatedParentCourseName\n  translatedParentLessonName\n  tagline\n  fullyTranslatedLanguages\n  subtitlesOnlyLanguages\n  __typename\n}\n\nfragment SearchSuggestionHit on Search_SuggestionHit {\n  id\n  name\n  score\n  __typename\n}\n\nfragment SearchProductCard on ProductCard_ProductCard {\n  id\n  canonicalType\n  marketingProductType\n  badges\n  productTypeAttributes {\n    ... on ProductCard_Specialization {\n      ...SearchProductCardSpecialization\n      __typename\n    }\n    ... on ProductCard_Course {\n      ...SearchProductCardCourse\n      __typename\n    }\n    ... on ProductCard_Clip {\n      ...SearchProductCardClip\n      __typename\n    }\n    ... on ProductCard_Degree {\n      ...SearchProductCardDegree\n      __typename\n    }\n    __typename\n  }\n  __typename\n}\n\nfragment SearchProductCardSpecialization on ProductCard_Specialization {\n  isPathwayContent\n  __typename\n}\n\nfragment SearchProductCardCourse on ProductCard_Course {\n  isPathwayContent\n  rating\n  reviewCount\n  __typename\n}\n\nfragment SearchProductCardClip on ProductCard_Clip {\n  canonical {\n    id\n    __typename\n  }\n  __typename\n}\n\nfragment SearchProductCardDegree on ProductCard_Degree {\n  canonical {\n    id\n    __typename\n  }\n  __typename\n}\n\nfragment SearchFacets on Search_Facet {\n  name\n  nameDisplay\n  valuesAndCounts {\n    ...ValuesAndCounts\n    __typename\n  }\n  __typename\n}\n\nfragment ValuesAndCounts on Search_FacetValueAndCount {\n  count\n  value\n  valueDisplay\n  __typename\n}\n"}]";
		
	    String payloadTemplate = "[{\"operationName\":\"Search\",\"variables\":{\"requests\":[{\"entityType\":\"PRODUCTS\",\"limit\":12,\"facets\":[\"cost\",\"topic\",\"skills\",\"productDifficultyLevel\",\"productDuration\",\"productTypeDescription\",\"partners\",\"language\",\"subtitleLanguage\",\"isPartOfCourseraPlus\"],\"sortBy\":\"BEST_MATCH\",\"maxValuesPerFacet\":1000,\"facetFilters\":[],\"cursor\":\"2\",\"query\":\"\"},{\"entityType\":\"SUGGESTIONS\",\"limit\":10,\"maxValuesPerFacet\":1000,\"facetFilters\":[],\"cursor\":\"0\",\"query\":\"\"}]},\"query\":\"query Search($requests: [Search_Request!]!) {\\n  SearchResult {\\n    search(requests: $requests) {\\n      ...SearchResult\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\\nfragment SearchResult on Search_Result {\\n  elements {\\n    ...SearchHit\\n    __typename\\n  }\\n  facets {\\n    ...SearchFacets\\n    __typename\\n  }\\n  pagination {\\n    cursor\\n    totalElements\\n    __typename\\n  }\\n  totalPages\\n  source {\\n    indexName\\n    recommender {\\n      context\\n      hash\\n      __typename\\n    }\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment SearchHit on Search_Hit {\\n  ...SearchArticleHit\\n  ...SearchProductHit\\n  ...SearchSuggestionHit\\n  __typename\\n}\\n\\nfragment SearchArticleHit on Search_ArticleHit {\\n  aeName\\n  careerField\\n  category\\n  createdByName\\n  firstPublishedAt\\n  id\\n  internalContentEpic\\n  internalProductLine\\n  internalTargetKw\\n  introduction\\n  islocalized\\n  lastPublishedAt\\n  localizedCountryCd\\n  localizedLanguageCd\\n  name\\n  subcategory\\n  topics\\n  url\\n  skill: skills\\n  __typename\\n}\\n\\nfragment SearchProductHit on Search_ProductHit {\\n  avgProductRating\\n  cobrandingEnabled\\n  completions\\n  duration\\n  id\\n  imageUrl\\n  isCourseFree\\n  isCreditEligible\\n  isNewContent\\n  isPartOfCourseraPlus\\n  name\\n  numProductRatings\\n  parentCourseName\\n  parentLessonName\\n  partnerLogos\\n  partners\\n  productCard {\\n    ...SearchProductCard\\n    __typename\\n  }\\n  productDifficultyLevel\\n  productDuration\\n  productType\\n  skills\\n  url\\n  videosInLesson\\n  translatedName\\n  translatedSkills\\n  translatedParentCourseName\\n  translatedParentLessonName\\n  tagline\\n  fullyTranslatedLanguages\\n  subtitlesOnlyLanguages\\n  __typename\\n}\\n\\nfragment SearchSuggestionHit on Search_SuggestionHit {\\n  id\\n  name\\n  score\\n  __typename\\n}\\n\\nfragment SearchProductCard on ProductCard_ProductCard {\\n  id\\n  canonicalType\\n  marketingProductType\\n  badges\\n  productTypeAttributes {\\n    ... on ProductCard_Specialization {\\n      ...SearchProductCardSpecialization\\n      __typename\\n    }\\n    ... on ProductCard_Course {\\n      ...SearchProductCardCourse\\n      __typename\\n    }\\n    ... on ProductCard_Clip {\\n      ...SearchProductCardClip\\n      __typename\\n    }\\n    ... on ProductCard_Degree {\\n      ...SearchProductCardDegree\\n      __typename\\n    }\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment SearchProductCardSpecialization on ProductCard_Specialization {\\n  isPathwayContent\\n  __typename\\n}\\n\\nfragment SearchProductCardCourse on ProductCard_Course {\\n  isPathwayContent\\n  rating\\n  reviewCount\\n  __typename\\n}\\n\\nfragment SearchProductCardClip on ProductCard_Clip {\\n  canonical {\\n    id\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment SearchProductCardDegree on ProductCard_Degree {\\n  canonical {\\n    id\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment SearchFacets on Search_Facet {\\n  name\\n  nameDisplay\\n  valuesAndCounts {\\n    ...ValuesAndCounts\\n    __typename\\n  }\\n  __typename\\n}\\n\\nfragment ValuesAndCounts on Search_FacetValueAndCount {\\n  count\\n  value\\n  valueDisplay\\n  __typename\\n}\\n\"}]";
	    
//	    Response res = Jsoup.connect(URL)
//	    		.userAgent("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36")
//	    .ignoreContentType(true)
//	    .method(Connection.Method.POST)
//	    .header("Accept", "application/json")
//	    .requestBody(payloadTemplate)
//	    .execute();
	    
	    Response res = Jsoup.connect(url)
                .ignoreContentType(true)
                .method(Connection.Method.POST)
                .userAgent("Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36")
                .header("Content-Type", "application/json")
                .requestBody(payloadTemplate)
                .timeout(60000)
                .execute();
	    
	    System.out.println(res.body());
	    
				
	}

}
